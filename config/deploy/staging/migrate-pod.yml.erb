---
apiVersion: v1
kind: Pod
metadata:
  name: migrate-<%= deployment_id %>
  namespace: ccs-staging
spec:
  # Max of 10 minute migrations; can adjust if we have longer ones
  activeDeadlineSeconds: 600
  restartPolicy: Never
  containers:
    - name: migrate
      image: us.gcr.io/bloom-general/crypto-cold-store:<%= current_sha %>
      command: ["bundle", "exec", "rake", "db:migrate"]
      env: <%= partial "env" %>
